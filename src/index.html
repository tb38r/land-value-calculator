<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./assets/index.css" />
    <title>W22 Land Value Calculator</title>
  </head>
  <body>
    <div id="root">
    <form id="myForm">
      <div class="main-container">
          <div class="container-outer">
            <div class="container-title">Units and Acres</div>
            <div class="inner-container">
              <div class="inner-question">
                Enter total number of residential units
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="total number of residential units" class="input-response" value=1000  />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter percentage of affordable units
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="percentage of affordable units?" class="input-response" value= 40 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                What percentage of affordable units are flats?
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="percentage of affordable flats" class="input-response"value= 20 />
            </div>


            <div class="inner-container">
              <div class=  "inner-question">
                What percentage of market units are flats?
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="percentage of market units flats" class="input-response" value= 20 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter the total number of Net Developable Acres
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="net developable acres" class="input-response" value= 80 />
            </div>
          </div>
          <div class="container-outer">
            <div class="container-title">Unit Sizes and Coverage</div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average size (NIA) Sq Ft for MARKET Houses
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average size sqft for market houses" class="input-response" value= 1000 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average size (NIA) Sq Ft for MARKET Flats
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average size sqft for market flats" class="input-response" value= 700 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average size (NIA) Sq Ft for AFFORDABLE Houses
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average size sqft for affordable houses" class="input-response" value= 900 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average size (NIA) Sq Ft for AFFORDABLE Flats
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average size sqft for affordable flats" class="input-response" value= 650 />
            </div>
          </div>
          <div class="container-outer">
            <div class="container-title">Estimated Sales Values</div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average sales price per Sq.Ft for Houses
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average sales price per sqft houses" class="input-response" value= 375 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average sales price per Sq.Ft for Flats
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average sales per sqft flats" class="input-response" value= 400 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter affordable discount to market value percentage for houses
                <div class="inner-legend">(%)</div>
              </div>
              <input
                type="number"
                name="affordable discount for houses"
                class="input-response"
                value= 30
              />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter affordable discount to market value percentage for flats
                <div class="inner-legend">(%)</div>
              </div>
              <input
                type="number"
                name="affordable discount for flats"
                class="input-response"
                value= 30
              />
            </div>
          </div>
          <div class="container-outer">
            <div class="container-title">Estimated Build Costs</div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average Build cost per Sq.Ft for MARKET Houses
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average cost for market houses" class="input-response" value= 170 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average Build Cost per Sq.Ft for MARKET Flats
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average cost for market flats" class="input-response" value = 200 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average Build cost per Sq.Ft for AFFORDABLE Houses
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="average build cost for affordable houses" class="input-response" value= 150 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter average Build Cost per Sq.Ft for AFFORDABLE Flats
                <div class="inner-legend">(#)</div>


              </div>
              <input type="number" 
              name="average build cost for affordable flats" class="input-response" value= 180 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter Other Developer costs - MARKET UNITS (e.g. sales and marketing, planning, etc) as a percentage of
                GDV. (default 2%)
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="Other costs market units" class="input-response" value = 2  />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter Other Developer costs - AFFORDABLE UNITS (e.g. sales and marketing, planning, etc) as a percentage
                of GDV. (default 2%)
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="other costs affordable units" class="input-response" value = 2 />
            </div>
          </div>
          <div class="container-outer">
            <div class="container-title">Developer's Target Margin &amp; Purchaser's Costs</div>
            <div class="inner-container">
              <div class="inner-question">
                Enter Developer's target margin percentage on MARKET UNITS (default 20%)
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="margin on market units" class="input-response"         value=20
              />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter Developer's target margin percentage on AFFORDABLE UNITS (default 20%)
                <div class="inner-legend">(%)</div>
              </div>
              <input
                type="number"
                name="margin on percentage affordable units"
                class="input-response"
                value=20
              />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter Purchaser's costs (default 6%)
                <div class="inner-legend">(%)</div>
              </div>
              <input type="number" name="Purchaser costs" class="input-response" value= 6 />
            </div>
          </div>
          <div class="container-outer">
            <div class="container-title">Planning and Servicing Cost Assumptions</div>
            <div class="inner-container">
              <div class="inner-question">
                Enter estimated infrastructure cost per acre (default £500k per acre)
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="estimated infrastructure cost" class="input-response" value="500000" />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter estimated S106 costs per unit (default £25k per unit)
                <div class="inner-legend">(£)</div>
              </div>
              <input type="number" name="estimated S106 costs" class="input-response" value="25000" />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter estimated Total CIL costs (default zero if not entered)
                <div class="inner-legend">(#)</div>
              </div>
              <input type="number" name="total cil" class="input-response" value = 1410000 />
            </div>
            <div class="inner-container">
              <div class="inner-question">
                Enter estimated planning costs 
                <div class="inner-legend">(£)</div>
              </div>
              <input type="number" name="estimated planning costs" class="input-response" value=1000000  />
            </div>
          </div>
          <button class="submit-button">SUBMIT</button>
        </form>
      </div>
    </body>
    <script>
      const form = document.getElementById('myForm');
      let formResults = {}

      form.addEventListener('submit', function (e) {
        e.preventDefault();
        let formData = new FormData(e.target);

        for (var vals of formData) {
          formResults[vals[0]] = vals[1]
        }


        console.log('formResults \n', formResults);
          
test()


      });
    </script>

    <script>
      //assumptions
      let market = {}
      let affordable = {}
      //let total = {}
      let residualServicedTotal = {}
      let affordableResidualServicedTotal = {}
      let totalUnserviced = {}



      const test = ()=>{

      market["residualUnits"]   = Math.ceil(formResults["total number of residential units"] * (1 - formResults["percentage of affordable units?"]/100))
      market[ "residualFlats"] = Math.ceil(market["residualUnits"] * (formResults['percentage of market units flats'])/100)
      market[ "residualHouses"] =    market["residualUnits"]- market[ "residualFlats"] 
      market['netDevelopableAcres'] = (formResults['net developable acres'] /formResults['total number of residential units']) * market["residualUnits"] 
      market['densityUnitsPerAcre'] =  market["residualUnits"] /    market['netDevelopableAcres']
      market['totalCoverageHouses'] = market[ "residualHouses"] * formResults['average size sqft for market houses']
      market['totalCoverageFlats'] = market[ "residualFlats"] * formResults['average size sqft for market flats']
      market['totalCoverage'] = market['totalCoverageHouses']+  market['totalCoverageFlats'] 
      market['coveragePerAcre'] =  market['totalCoverage'] /   market['netDevelopableAcres']
      market['salesPricesPerSQFT'] = ((market[ "residualHouses"] * formResults['average sales price per sqft houses']) +  (market[ "residualFlats"] * formResults['average sales per sqft flats']))/market["residualUnits"]
      market['buildCostsPerSSQFT'] = ((market[ "residualHouses"] * formResults['average cost for market houses']) +  (market[ "residualFlats"] * formResults['average cost for market flats']))/market["residualUnits"]

   
      affordable["residualUnits"]   = Math.ceil(formResults["total number of residential units"] * (formResults["percentage of affordable units?"]/100))
      affordable[ "residualFlats"] = Math.ceil(affordable["residualUnits"] * (formResults['percentage of affordable flats'])/100)
      affordable[ "residualHouses"] =    affordable["residualUnits"]- affordable[ "residualFlats"] 
      affordable['netDevelopableAcres'] = (formResults['net developable acres'] /formResults['total number of residential units']) * affordable["residualUnits"] 
      affordable['densityUnitsPerAcre'] =  affordable["residualUnits"] /    affordable['netDevelopableAcres']
      affordable['totalCoverageHouses'] = affordable[ "residualHouses"] * formResults['average size sqft for affordable houses']
      affordable['totalCoverageFlats'] = affordable[ "residualFlats"] * formResults['average size sqft for affordable flats']
      affordable['totalCoverage'] = affordable['totalCoverageHouses']+  affordable['totalCoverageFlats'] 
      affordable['coveragePerAcre'] =  affordable['totalCoverage'] /   affordable['netDevelopableAcres']
      affordable['salesPriceAffordableHouses'] = formResults['average sales price per sqft houses'] * (1-(formResults['affordable discount for houses']/100))
      affordable['salesPriceAffordableFlats'] = formResults['average sales per sqft flats'] * (1-(formResults['affordable discount for flats']/100))
      affordable['salesPricesPerSQFT'] = ((affordable[ "residualHouses"] *   affordable['salesPriceAffordableHouses']) +  (affordable[ "residualFlats"] *      affordable['salesPriceAffordableFlats']))/affordable["residualUnits"]
      affordable['buildCostsPerSSQFT'] = ((affordable[ "residualHouses"] * formResults['average build cost for affordable houses']) +  (affordable[ "residualFlats"] * formResults['average build cost for affordable flats']))/affordable["residualUnits"]

    
      final()
    }
    console.log('Market--->\n', market);
    console.log('Affordable---> \n', affordable);


    </script>


<script>
  const final =()=>{
          residualServicedTotal['Market GDV'] =   market['totalCoverage'] * market['salesPricesPerSQFT'] 
          residualServicedTotal['Market build cost'] = market['totalCoverage'] *    -market['buildCostsPerSSQFT'] 
        residualServicedTotal['Market other developer costs'] = residualServicedTotal['Market GDV'] * (-formResults['Other costs market units']/100)
         residualServicedTotal['Market Developer Margin'] =    residualServicedTotal['Market GDV'] * (-formResults['margin on market units']/100)
         residualServicedTotal['Estimated Serviced land value pre purchaser'] =  residualServicedTotal['Market GDV'] + residualServicedTotal['Market build cost']+residualServicedTotal['Market other developer costs']+      residualServicedTotal['Market Developer Margin']
 
        residualServicedTotal['Market purchasers costs'] = -residualServicedTotal['Estimated Serviced land value pre purchaser'] * ((formResults['Purchaser costs']/100) / (1+(formResults['Purchaser costs'])/100))
        residualServicedTotal['Market Estimated service land val post purchaser costs'] =      residualServicedTotal['Estimated Serviced land value pre purchaser'] + residualServicedTotal['Market purchasers costs']
        
        
        affordableResidualServicedTotal['GDV'] =   affordable['totalCoverage'] * affordable['salesPricesPerSQFT'] 
          affordableResidualServicedTotal['build cost'] = affordable['totalCoverage'] *    -affordable['buildCostsPerSSQFT'] 
        affordableResidualServicedTotal['other developer costs'] = affordableResidualServicedTotal['GDV'] * (-1*(formResults['other costs affordable units']/100))
         affordableResidualServicedTotal['Developer Margin'] =    affordableResidualServicedTotal['GDV'] * (-formResults['margin on percentage affordable units']/100)
         affordableResidualServicedTotal['Estimated Serviced land value pre purchaser'] =  affordableResidualServicedTotal['GDV'] + affordableResidualServicedTotal['build cost'] + affordableResidualServicedTotal['other developer costs']+    affordableResidualServicedTotal['Developer Margin']
 
        affordableResidualServicedTotal['purchasers costs'] = -(affordableResidualServicedTotal['Estimated Serviced land value pre purchaser']) * ((formResults['Purchaser costs']/100) / (1+(formResults['Purchaser costs'])/100))
        affordableResidualServicedTotal['Estimated service land val post purchaser costs'] =      affordableResidualServicedTotal['Estimated Serviced land value pre purchaser'] + affordableResidualServicedTotal['purchasers costs']
        
        //top row
        let totalEstimatedServiceLandValuePostPurchasersCosts = Math.ceil(residualServicedTotal['Market Estimated service land val post purchaser costs'] +    affordableResidualServicedTotal['Estimated service land val post purchaser costs'])
     
//let a =  ( affordableResidualServicedTotal['Estimated Serviced land value pre purchaser'] + residualServicedTotal['Estimated Serviced land value pre purchaser'])

//let totalInfrastructureCosts = (formResults['estimated infrastructure cost']* formResults['net developable acres'])
//let c = (formResults['estimated S106 costs']*formResults['total number of residential units'])
//let cil = formResults['total cil']
//let epc = formResults['estimated planning costs'] * totalInfrastructureCosts



totalUnserviced['Estimated Land value pre purchaser cost'] =  ( affordableResidualServicedTotal['Estimated Serviced land value pre purchaser'] + residualServicedTotal['Estimated Serviced land value pre purchaser']) - (formResults['estimated infrastructure cost']* formResults['net developable acres']) - (formResults['estimated S106 costs']*formResults['total number of residential units'])-formResults['total cil'] -formResults['estimated planning costs']

totalUnserviced['Purchaser costs'] = totalUnserviced['Estimated Land value pre purchaser cost'] * -((formResults['Purchaser costs']/100)/(1+(formResults['Purchaser costs']/100)))

totalUnserviced['Estimated Unserviced Land value (post purchaser costs)'] = totalUnserviced['Estimated Land value pre purchaser cost'] + totalUnserviced['Purchaser costs']
/*
console.log('totalUnserviced \n', totalUnserviced);

console.log('residualTotals\n', residualServicedTotal);
        console.log('affordableTotal \n',affordableResidualServicedTotal );
        console.log(' totalEstimatedServiceLandValuePostPurchasersCosts \n ', totalEstimatedServiceLandValuePostPurchasersCosts);
       
        
       
*/

 let totalServicePerAcre = Math.ceil(totalEstimatedServiceLandValuePostPurchasersCosts / formResults['net developable acres'])
let totalServicePerUnit = Math.ceil(totalEstimatedServiceLandValuePostPurchasersCosts/formResults['total number of residential units'])

let totalUnservicedLandValCost = Math.ceil(totalUnserviced['Estimated Unserviced Land value (post purchaser costs)'])
let totalUnservicedPerAcre = Math.ceil(totalUnservicedLandValCost/formResults['net developable acres'])
let totalUnservicedPerUnit = Math.ceil(totalUnservicedLandValCost/formResults['total number of residential units'])


    //top row
    console.log('totalEstimatedServiceLandValuePostPurchasersCosts',totalEstimatedServiceLandValuePostPurchasersCosts);
   console.log('totalPerAcre',totalServicePerAcre );
   console.log('totalperUnit',totalServicePerUnit );

        //bottom row
        console.log('Estimated Unserviced Land value (post purchaser costs', totalUnservicedLandValCost);
        console.log('Unserviced per Acre', totalUnservicedPerAcre);
        console.log('Unserviced per Unit', totalUnservicedPerUnit);
     
     
     
      }

 
</script>
</html>
